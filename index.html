<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Claw - AI Agent Control Center</title>
    <style>
        :root {
            /* Light Mode Colors */
            --bg-primary: #FFFFFF;
            --bg-secondary: #F2F2F7;
            --text-primary: #000000;
            --text-secondary: #6D6D70;
            --claw-orange: #FF6B35;
            --claw-orange-light: #FF8555;
            --success: #27AE60;
            --warning: #F39C12;
            --error: #E74C3C;
            --online: #27AE60;
            --offline: #95A5A6;
            --border: #E5E5EA;
            --shadow: rgba(0,0,0,0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1C1C1E;
                --bg-secondary: #2C2C2E;
                --text-primary: #FFFFFF;
                --text-secondary: #8E8E93;
                --claw-orange-light: #FF8555;
                --success: #32D74B;
                --warning: #FFD60A;
                --error: #FF453A;
                --online: #32D74B;
                --offline: #8E8E93;
                --border: #3A3A3C;
                --shadow: rgba(0,0,0,0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            touch-action: manipulation;
        }

        /* Status Bar */
        .status-bar {
            height: 44px;
            background: var(--bg-primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            border-bottom: 1px solid var(--border);
        }

        .status-left {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-right {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Main App Container */
        .app-container {
            height: calc(100vh - 44px - 83px);
            position: relative;
            overflow: hidden;
        }

        /* Agent Sidebar */
        .agent-sidebar {
            position: absolute;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100%;
            background: var(--bg-primary);
            border-right: 1px solid var(--border);
            transition: left 0.3s ease-out;
            z-index: 1000;
            overflow-y: auto;
        }

        .agent-sidebar.open {
            left: 0;
        }

        .sidebar-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-out;
            z-index: 999;
        }

        .sidebar-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .agent-group {
            margin: 20px 0;
        }

        .agent-group-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin: 0 20px 10px 20px;
        }

        .agent-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .agent-item:hover {
            background: var(--bg-secondary);
        }

        .agent-icon {
            font-size: 24px;
            margin-right: 15px;
        }

        .agent-info {
            flex: 1;
        }

        .agent-name {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .agent-status {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .agent-status.online::before {
            content: "‚óè";
            color: var(--online);
            margin-right: 5px;
        }

        .agent-status.offline::before {
            content: "‚óè";
            color: var(--offline);
            margin-right: 5px;
        }

        /* Screen Container */
        .screen {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background: var(--bg-primary);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }

        .screen.active {
            opacity: 1;
            visibility: visible;
            z-index: 10;
        }

        /* Home Screen */
        .home-header {
            padding: 20px;
            text-align: center;
        }

        .claw-logo {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .claw-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--claw-orange);
        }

        .welcome-card {
            background: linear-gradient(135deg, var(--claw-orange) 0%, var(--claw-orange-light) 100%);
            margin: 20px;
            padding: 20px;
            border-radius: 16px;
            color: white;
        }

        .welcome-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .welcome-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .welcome-stat {
            text-align: center;
        }

        .stat-number {
            font-size: 20px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }

        .section {
            margin: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .recent-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .recent-item:hover {
            background: var(--border);
        }

        .recent-agent {
            font-size: 20px;
            margin-right: 15px;
        }

        .recent-content {
            flex: 1;
        }

        .recent-name {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .recent-message {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .recent-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .unread-dot {
            width: 8px;
            height: 8px;
            background: var(--claw-orange);
            border-radius: 50%;
            margin-left: 10px;
        }

        /* Chat Screen */
        .chat-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
        }

        .menu-button {
            font-size: 18px;
            margin-right: 15px;
            cursor: pointer;
            padding: 5px;
        }

        .chat-title {
            flex: 1;
            display: flex;
            align-items: center;
        }

        .chat-agent-icon {
            font-size: 20px;
            margin-right: 10px;
        }

        .chat-info {
            flex: 1;
        }

        .chat-agent-name {
            font-size: 16px;
            font-weight: 600;
        }

        .chat-agent-status {
            font-size: 12px;
            color: var(--online);
        }

        .chat-options {
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            height: calc(100% - 140px);
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .message.user {
            align-items: flex-end;
        }

        .message.agent {
            align-items: flex-start;
        }

        .message-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 16px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .message.user .message-bubble {
            background: var(--claw-orange);
            color: white;
        }

        .message.agent .message-bubble {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .message-time {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 5px;
            padding: 0 5px;
        }

        .agent-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 5px;
            padding: 0 5px;
        }

        .status-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 15px;
        }

        .status-icon {
            margin-right: 8px;
        }

        .progress-container {
            margin: 15px 0;
            padding: 15px;
            background: var(--bg-primary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .progress-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .progress-bar {
            background: var(--border);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            position: relative;
            margin: 10px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--success), #45a049);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .progress-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .progress-button {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 12px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .progress-button:hover {
            background: var(--bg-secondary);
        }

        /* Input Container */
        .input-container {
            background: var(--bg-primary);
            padding: 15px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .input-field {
            flex: 1;
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 12px 16px;
            font-size: 16px;
            outline: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .input-field:focus {
            border-color: var(--claw-orange);
            background: var(--bg-primary);
        }

        .input-button {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: background 0.2s ease;
        }

        .input-button:hover {
            background: var(--border);
        }

        .send-button {
            background: var(--claw-orange);
            color: white;
        }

        .send-button:hover {
            background: var(--claw-orange-light);
        }

        /* Tab Bar */
        .tab-bar {
            height: 83px;
            background: var(--bg-primary);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: env(safe-area-inset-bottom);
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: color 0.2s ease;
            color: var(--text-secondary);
            padding: 5px;
            flex: 1;
        }

        .tab-item.active {
            color: var(--claw-orange);
        }

        .tab-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .tab-label {
            font-size: 10px;
            font-weight: 500;
        }

        /* Processes Screen */
        .processes-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
        }

        .processes-title {
            font-size: 20px;
            font-weight: 700;
        }

        .processes-actions {
            display: flex;
            gap: 15px;
        }

        .header-button {
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            color: var(--claw-orange);
        }

        .process-section {
            margin: 20px;
        }

        .process-section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .section-count {
            background: var(--claw-orange);
            color: white;
            font-size: 12px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 12px;
            margin-left: 10px;
        }

        .process-item {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .process-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .process-icon {
            font-size: 18px;
            margin-right: 10px;
        }

        .process-info {
            flex: 1;
        }

        .process-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .process-agent {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .process-meta {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .process-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .process-button {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 12px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .process-button:hover {
            background: var(--bg-secondary);
        }

        /* Apps Screen */
        .app-section {
            margin: 20px;
        }

        .app-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .app-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 15px 5px;
            transition: transform 0.2s ease;
        }

        .app-item:hover {
            transform: scale(1.05);
        }

        .app-icon {
            font-size: 32px;
            margin-bottom: 8px;
            position: relative;
        }

        .app-status {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid var(--bg-primary);
        }

        .app-status.connected {
            background: var(--online);
        }

        .app-status.disconnected {
            background: var(--offline);
        }

        .app-label {
            font-size: 12px;
            text-align: center;
            color: var(--text-primary);
        }

        /* Settings Screen */
        .settings-section {
            margin: 20px 0;
        }

        .settings-group {
            background: var(--bg-secondary);
            border-radius: 12px;
            margin: 0 20px 20px 20px;
            overflow: hidden;
        }

        .settings-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .settings-item:hover {
            background: var(--border);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-icon {
            font-size: 18px;
            margin-right: 15px;
            width: 20px;
        }

        .settings-content {
            flex: 1;
        }

        .settings-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .settings-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .settings-value {
            font-size: 14px;
            color: var(--text-secondary);
            margin-right: 5px;
        }

        .settings-chevron {
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 320px) {
            .app-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Animations */
        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message {
            animation: messageSlideIn 0.3s ease-out;
        }

        /* Touch feedback */
        .tab-item:active,
        .agent-item:active,
        .process-button:active,
        .settings-item:active,
        .recent-item:active,
        .app-item:active {
            opacity: 0.6;
            transform: scale(0.98);
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 15px;
            font-style: italic;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .typing-dots {
            margin-left: 10px;
        }

        .typing-dots span {
            animation: typingDot 1.4s infinite;
            opacity: 0.4;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingDot {
            0%, 60%, 100% {
                opacity: 0.4;
            }
            30% {
                opacity: 1;
            }
        }
    
        /* Agent Avatar Colors */
        .agent-icon, .recent-agent, .chat-agent-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
            color: white;
        }
        
        .agent-dee { background: linear-gradient(135deg, #FF6B35, #FF8555); }
        .agent-zera { background: linear-gradient(135deg, #3B82F6, #60A5FA); }
        .agent-yacob { background: linear-gradient(135deg, #22C55E, #4ADE80); }
        .agent-aman { background: linear-gradient(135deg, #8B5CF6, #A78BFA); }
        
        .process-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .process-icon.running {
            background: rgba(59, 130, 246, 0.2);
            color: #3B82F6;
        }
        
        .process-icon.running svg {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .process-icon.scheduled {
            background: rgba(245, 158, 11, 0.2);
            color: #F59E0B;
        }
        
        .status-icon {
            display: inline-flex;
            align-items: center;
            margin-right: 4px;
        }
        
        .claw-logo svg {
            color: var(--claw-orange);
        }

    </style>
</head>
<body>
    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-left">
            ‚óÄ <span id="currentTime">9:41</span>
        </div>
        <div class="status-right">
            100% ‚ñÆ‚ñÆ‚ñÆ‚ñÆ üì∂
        </div>
    </div>

    <!-- Agent Sidebar -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="agent-sidebar" id="agentSidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">AGENTS</div>
        </div>
        
        <div class="agent-group">
            <div class="agent-group-title">LOCAL MAC</div>
            <div class="agent-item" data-agent="dee-dee">
                <div class="agent-icon agent-dee">D</div>
                <div class="agent-info">
                    <div class="agent-name">Dee Dee</div>
                    <div class="agent-status online">online</div>
                </div>
            </div>
        </div>

        <div class="agent-group">
            <div class="agent-group-title">ILLICIT.FINANCE</div>
            <div class="agent-item" data-agent="zera">
                <div class="agent-icon agent-zera">Z</div>
                <div class="agent-info">
                    <div class="agent-name">Zera</div>
                    <div class="agent-status online">online</div>
                </div>
            </div>
            <div class="agent-item" data-agent="yacob">
                <div class="agent-icon agent-yacob">Y</div>
                <div class="agent-info">
                    <div class="agent-name">Yacob</div>
                    <div class="agent-status online">online</div>
                </div>
            </div>
            <div class="agent-item" data-agent="aman">
                <div class="agent-icon agent-aman">A</div>
                <div class="agent-info">
                    <div class="agent-name">Aman</div>
                    <div class="agent-status offline">offline</div>
                </div>
            </div>
        </div>

        <div class="agent-group">
            <div class="agent-group-title">OUTSTANDING SERVER</div>
            <div class="agent-item" data-agent="outstanding">
                <div class="agent-icon agent-yacob">Y</div>
                <div class="agent-info">
                    <div class="agent-name">Outstanding</div>
                    <div class="agent-status online">online</div>
                </div>
            </div>
        </div>

        <div class="agent-group">
            <div class="agent-item" data-action="add-gateway">
                <div class="agent-icon">+</div>
                <div class="agent-info">
                    <div class="agent-name">Add Gateway</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Home Screen -->
        <div class="screen active" id="homeScreen">
            <div class="home-header">
                <div class="claw-logo"><svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/><path d="M8 12l2 2 4-4"/></svg></div>
                <div class="claw-title">CLAW</div>
            </div>

            <div class="welcome-card">
                <div class="welcome-title">Welcome back, JJ</div>
                <div class="welcome-stats">
                    <div class="welcome-stat">
                        <div class="stat-number" id="agentCount">4</div>
                        <div class="stat-label">agents online</div>
                    </div>
                    <div class="welcome-stat">
                        <div class="stat-number" id="taskCount">2</div>
                        <div class="stat-label">tasks running</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Recent</div>
                
                <div class="recent-item" data-agent="dee-dee">
                    <div class="recent-agent agent-dee">D</div>
                    <div class="recent-content">
                        <div class="recent-name">Dee Dee</div>
                        <div class="recent-message">"Done! Outstanding will..."</div>
                        <div class="recent-time">2 min ago</div>
                    </div>
                    <div class="unread-dot"></div>
                </div>

                <div class="recent-item" data-agent="aman">
                    <div class="recent-agent agent-aman">A</div>
                    <div class="recent-content">
                        <div class="recent-name">Aman</div>
                        <div class="recent-message">"Research report ready..."</div>
                        <div class="recent-time">15 min ago</div>
                    </div>
                </div>

                <div class="recent-item" data-agent="yacob">
                    <div class="recent-agent agent-yacob">Y</div>
                    <div class="recent-content">
                        <div class="recent-name">Yacob</div>
                        <div class="recent-message">"Infrastructure specs..."</div>
                        <div class="recent-time">1 hour ago</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Screen -->
        <div class="screen" id="chatScreen">
            <div class="chat-header">
                <div class="menu-button" id="menuButton">‚â°</div>
                <div class="chat-title">
                    <div class="chat-agent-icon agent-dee" id="chatAgentIcon">D</div>
                    <div class="chat-info">
                        <div class="chat-agent-name" id="chatAgentName">Dee Dee</div>
                        <div class="chat-agent-status" id="chatAgentStatus">‚óè online</div>
                    </div>
                </div>
                <div class="chat-options">‚ãÆ</div>
            </div>

            <div class="chat-container" id="chatContainer">
                <!-- Sample conversation -->
                <div class="message user">
                    <div class="message-bubble">
                        Check if the outstanding server is responding
                    </div>
                    <div class="message-time">10:30 AM</div>
                </div>

                <div class="message agent">
                    <div class="agent-label">Dee Dee</div>
                    <div class="message-bubble">
                        Let me check...
                        <div class="status-item">
                            <span class="status-icon success"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="#22C55E" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg></span> SSH connection: OK
                        </div>
                        <div class="status-item">
                            <span class="status-icon success"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="#22C55E" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg></span> Tailscale: 100.81.194.31
                        </div>
                        <div class="status-item">
                            <span class="status-icon success"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="#22C55E" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg></span> PostgreSQL: Running
                        </div>
                        <div class="status-item">
                            <span class="status-icon success"><svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="#22C55E" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg></span> Uptime: 2 days, 4 hours
                        </div>
                        <br>
                        Outstanding is healthy!
                    </div>
                    <div class="message-time">10:30 AM</div>
                </div>

                <div class="message user">
                    <div class="message-bubble">
                        Great, run the RSMeans import
                    </div>
                    <div class="message-time">10:32 AM</div>
                </div>

                <div class="message agent">
                    <div class="agent-label">Dee Dee</div>
                    <div class="message-bubble">
                        Starting import...
                        <div class="progress-container">
                            <div class="progress-title">Process Started</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 67%" id="sampleProgress"></div>
                                <div class="progress-text">rsmeans-import - 67%</div>
                            </div>
                            <div class="progress-actions">
                                <div class="progress-button">View Logs</div>
                                <div class="progress-button">Cancel</div>
                            </div>
                        </div>
                    </div>
                    <div class="message-time">10:32 AM</div>
                </div>
            </div>

            <div id="typingIndicator" class="typing-indicator" style="display: none;">
                Agent is typing
                <div class="typing-dots">
                    <span>.</span><span>.</span><span>.</span>
                </div>
            </div>

            <div class="input-container">
                <input type="text" class="input-field" placeholder="Message Dee Dee..." id="messageInput">
                <div class="input-button">üé§</div>
                <div class="input-button">üìé</div>
                <div class="input-button send-button" id="sendButton">‚û§</div>
            </div>
        </div>

        <!-- Processes Screen -->
        <div class="screen" id="processesScreen">
            <div class="processes-header">
                <div class="processes-title">Processes</div>
                <div class="processes-actions">
                    <div class="header-button" id="refreshProcesses">‚ü≥</div>
                    <div class="header-button">‚ãÆ</div>
                </div>
            </div>

            <div id="processesContainer" style="overflow-y: auto; height: calc(100% - 60px);">
                <div class="process-section">
                    <div class="process-section-title">
                        Running <div class="section-count" id="runningCount">2</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon running"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 11-6.219-8.56"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">rsmeans-import</div>
                                <div class="process-agent">Dee Dee</div>
                            </div>
                        </div>
                        <div class="process-meta">outstanding ¬∑ Started 5m ago</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 67%"></div>
                            <div class="progress-text">Progress: 67%</div>
                        </div>
                        <div class="process-actions">
                            <div class="process-button">Logs</div>
                            <div class="process-button">Stop</div>
                        </div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon running"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 11-6.219-8.56"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">market-analysis</div>
                                <div class="process-agent">Aman</div>
                            </div>
                        </div>
                        <div class="process-meta">outstanding ¬∑ Started 12m ago</div>
                        <div style="margin: 10px 0; color: var(--text-secondary);">Analyzing Q4 data...</div>
                        <div class="process-actions">
                            <div class="process-button">Logs</div>
                            <div class="process-button">Stop</div>
                        </div>
                    </div>
                </div>

                <div class="process-section">
                    <div class="process-section-title">
                        Scheduled <div class="section-count">3</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon scheduled"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">Check email</div>
                                <div class="process-agent">Dee Dee</div>
                            </div>
                        </div>
                        <div class="process-meta">Every 30 min ¬∑ Next: 12 min</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon scheduled"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">Backup databases</div>
                                <div class="process-agent">Yacob</div>
                            </div>
                        </div>
                        <div class="process-meta">Daily @ 3:00 AM ¬∑ Next: 5h 20m</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon scheduled"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">Market opening alert</div>
                                <div class="process-agent">Aman</div>
                            </div>
                        </div>
                        <div class="process-meta">Weekdays @ 9:30 AM ¬∑ Next: Mon</div>
                    </div>
                </div>

                <div class="process-section">
                    <div class="process-section-title">
                        Recent <div class="section-count">5</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon completed"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="#22C55E" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">SSH config fix</div>
                                <div class="process-agent">Yacob</div>
                            </div>
                        </div>
                        <div class="process-meta">2h ago</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon completed"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="#22C55E" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg></div>
                            <div class="process-info">
                                <div class="process-name">Tailscale setup</div>
                                <div class="process-agent">Dee Dee</div>
                            </div>
                        </div>
                        <div class="process-meta">8h ago</div>
                    </div>

                    <div class="process-item">
                        <div class="process-header">
                            <div class="process-icon">‚ùå</div>
                            <div class="process-info">
                                <div class="process-name">GPU training (OOM)</div>
                                <div class="process-agent">Aman</div>
                            </div>
                        </div>
                        <div class="process-meta">1d ago</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Apps Screen -->
        <div class="screen" id="appsScreen">
            <div class="processes-header">
                <div class="processes-title">Apps</div>
                <div class="processes-actions">
                    <div class="header-button">[+]</div>
                </div>
            </div>

            <div style="overflow-y: auto; height: calc(100% - 60px);">
                <div class="app-section">
                    <div class="section-title">Connected</div>
                    <div class="app-grid">
                        <div class="app-item">
                            <div class="app-icon">
                                üì±
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Telegram</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üìß
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Gmail</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üìÖ
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Calendar</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üìù
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Notes</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üí¨
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Slack</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üè†
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">HomeKit</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üìç
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Location</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üîî
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Reminders</div>
                        </div>
                    </div>
                </div>

                <div class="app-section">
                    <div class="section-title">Available</div>
                    <div class="app-grid">
                        <div class="app-item">
                            <div class="app-icon">
                                üê¶
                                <div class="app-status disconnected"></div>
                            </div>
                            <div class="app-label">Twitter</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üì∏
                                <div class="app-status disconnected"></div>
                            </div>
                            <div class="app-label">Instagram</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üéµ
                                <div class="app-status disconnected"></div>
                            </div>
                            <div class="app-label">Spotify</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üíª
                                <div class="app-status disconnected"></div>
                            </div>
                            <div class="app-label">GitHub</div>
                        </div>
                    </div>
                </div>

                <div class="app-section">
                    <div class="section-title">Agent Capabilities</div>
                    <div class="app-grid">
                        <div class="app-item">
                            <div class="app-icon">
                                üñ•Ô∏è
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Terminal</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üåê
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Browser</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                üìÅ
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">Files</div>
                        </div>
                        <div class="app-item">
                            <div class="app-icon">
                                Settings
                                <div class="app-status connected"></div>
                            </div>
                            <div class="app-label">System</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Screen -->
        <div class="screen" id="settingsScreen">
            <div class="processes-header">
                <div class="processes-title">Settings</div>
            </div>

            <div style="overflow-y: auto; height: calc(100% - 60px);">
                <div class="settings-section">
                    <div class="settings-group">
                        <div class="settings-item">
                            <div class="settings-icon">üë§</div>
                            <div class="settings-content">
                                <div class="settings-title">JJ</div>
                                <div class="settings-subtitle">jarrelljames0@gmail.com</div>
                            </div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-item">
                            <div class="settings-icon">üñ•Ô∏è</div>
                            <div class="settings-content">
                                <div class="settings-title">Local Mac</div>
                                <div class="settings-subtitle">‚óè online</div>
                            </div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon">‚òÅÔ∏è</div>
                            <div class="settings-content">
                                <div class="settings-title">illicit.finance</div>
                                <div class="settings-subtitle">‚óè online</div>
                            </div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon"><svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></div>
                            <div class="settings-content">
                                <div class="settings-title">Outstanding Server</div>
                                <div class="settings-subtitle">‚óè online</div>
                            </div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon">+</div>
                            <div class="settings-content">
                                <div class="settings-title">Add Gateway</div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-item">
                            <div class="settings-icon">üîî</div>
                            <div class="settings-content">
                                <div class="settings-title">Push Notifications</div>
                            </div>
                            <div class="settings-value">üîò</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon">üîä</div>
                            <div class="settings-content">
                                <div class="settings-title">Sound</div>
                            </div>
                            <div class="settings-value">üîò</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon">üì≥</div>
                            <div class="settings-content">
                                <div class="settings-title">Vibrate</div>
                            </div>
                            <div class="settings-value">üîò</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon">üëÅÔ∏è</div>
                            <div class="settings-content">
                                <div class="settings-title">Show Previews</div>
                            </div>
                            <div class="settings-value">Always</div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-item">
                            <div class="settings-icon">üé®</div>
                            <div class="settings-content">
                                <div class="settings-title">Theme</div>
                            </div>
                            <div class="settings-value">Auto</div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon">üì±</div>
                            <div class="settings-content">
                                <div class="settings-title">App Icon</div>
                            </div>
                            <div class="settings-value">Classic</div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-item">
                            <div class="settings-icon">üîí</div>
                            <div class="settings-content">
                                <div class="settings-title">Face ID</div>
                            </div>
                            <div class="settings-value">üîò</div>
                        </div>
                        <div class="settings-item">
                            <div class="settings-icon"><svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
                            <div class="settings-content">
                                <div class="settings-title">Auto-Lock</div>
                            </div>
                            <div class="settings-value">1 min</div>
                            <div class="settings-chevron">‚ñ∂</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Bar -->
    <div class="tab-bar">
        <div class="tab-item active" data-screen="home">
            <div class="tab-icon">üè†</div>
            <div class="tab-label">Home</div>
        </div>
        <div class="tab-item" data-screen="chat">
            <div class="tab-icon">üí¨</div>
            <div class="tab-label">Chats</div>
        </div>
        <div class="tab-item" data-screen="processes">
            <div class="tab-icon">‚ö°</div>
            <div class="tab-label">Processes</div>
        </div>
        <div class="tab-item" data-screen="apps">
            <div class="tab-icon">üì±</div>
            <div class="tab-label">Apps</div>
        </div>
        <div class="tab-item" data-screen="settings">
            <div class="tab-icon">‚öôÔ∏è</div>
            <div class="tab-label">Settings</div>
        </div>
    </div>

    <script>
        class ClawMobileApp {
            constructor() {
                this.currentScreen = 'home';
                this.currentAgent = 'dee-dee';
                this.sidebarOpen = false;
                this.apiBase = window.location.origin;
                this.ws = null;
                
                this.initElements();
                this.setupEventListeners();
                this.updateTime();
                this.setupTouchEvents();
                this.connectWebSocket();
                
                // Update time every minute
                setInterval(() => this.updateTime(), 60000);
                
                // Animate progress bar periodically for demo
                this.animateProgressBars();
            }

            initElements() {
                this.sidebar = document.getElementById('agentSidebar');
                this.sidebarOverlay = document.getElementById('sidebarOverlay');
                this.menuButton = document.getElementById('menuButton');
                this.chatContainer = document.getElementById('chatContainer');
                this.messageInput = document.getElementById('messageInput');
                this.sendButton = document.getElementById('sendButton');
                this.currentTimeEl = document.getElementById('currentTime');
                this.chatAgentIcon = document.getElementById('chatAgentIcon');
                this.chatAgentName = document.getElementById('chatAgentName');
                this.chatAgentStatus = document.getElementById('chatAgentStatus');
                this.typingIndicator = document.getElementById('typingIndicator');
                this.agentCountEl = document.getElementById('agentCount');
                this.taskCountEl = document.getElementById('taskCount');
            }

            setupEventListeners() {
                // Tab navigation
                document.querySelectorAll('.tab-item').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const screen = tab.dataset.screen;
                        this.switchScreen(screen);
                    });
                });

                // Menu button for sidebar
                this.menuButton.addEventListener('click', () => {
                    this.toggleSidebar();
                });

                // Sidebar overlay
                this.sidebarOverlay.addEventListener('click', () => {
                    this.closeSidebar();
                });

                // Agent selection
                document.querySelectorAll('.agent-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const agent = item.dataset.agent;
                        if (agent) {
                            this.selectAgent(agent);
                            this.closeSidebar();
                        }
                    });
                });

                // Send message
                this.sendButton.addEventListener('click', () => {
                    this.sendMessage();
                });

                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendMessage();
                    }
                });

                // Recent items navigation
                document.querySelectorAll('.recent-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const agent = item.dataset.agent;
                        if (agent) {
                            this.selectAgent(agent);
                        }
                        this.switchScreen('chat');
                    });
                });

                // Process refresh
                const refreshBtn = document.getElementById('refreshProcesses');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', () => {
                        this.refreshProcesses();
                    });
                }
            }

            setupTouchEvents() {
                let startX = 0;
                let isSwipeFromEdge = false;

                document.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                    isSwipeFromEdge = startX < 20;
                }, { passive: true });

                document.addEventListener('touchmove', (e) => {
                    if (!isSwipeFromEdge) return;
                    
                    const currentX = e.touches[0].clientX;
                    const diff = currentX - startX;
                    
                    if (diff > 50 && !this.sidebarOpen) {
                        this.openSidebar();
                        isSwipeFromEdge = false;
                    }
                }, { passive: true });
            }

            connectWebSocket() {
                try {
                    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                    const wsUrl = `${protocol}//${window.location.host}/ws`;
                    
                    this.ws = new WebSocket(wsUrl);
                    
                    this.ws.onopen = () => {
                        console.log('WebSocket connected');
                        this.updateAgentStatus('online');
                    };

                    this.ws.onmessage = (event) => {
                        try {
                            const data = JSON.parse(event.data);
                            this.handleWebSocketMessage(data);
                        } catch (e) {
                            console.error('WebSocket message parse error:', e);
                        }
                    };

                    this.ws.onclose = () => {
                        console.log('WebSocket disconnected');
                        this.updateAgentStatus('offline');
                        // Attempt reconnect after 3 seconds
                        setTimeout(() => this.connectWebSocket(), 3000);
                    };

                    this.ws.onerror = (error) => {
                        console.error('WebSocket error:', error);
                        this.updateAgentStatus('error');
                    };
                } catch (error) {
                    console.error('WebSocket connection failed:', error);
                    this.updateAgentStatus('offline');
                }
            }

            handleWebSocketMessage(data) {
                switch (data.type) {
                    case 'agent_message':
                        this.addMessage(data.message, false, data.agent);
                        break;
                    case 'agent_status':
                        this.updateAgentStatus(data.status, data.agent);
                        break;
                    case 'process_update':
                        this.updateProcessStatus(data);
                        break;
                    case 'typing_start':
                        this.showTypingIndicator();
                        break;
                    case 'typing_end':
                        this.hideTypingIndicator();
                        break;
                }
            }

            updateTime() {
                const now = new Date();
                const time = now.toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: false
                });
                this.currentTimeEl.textContent = time;
            }

            switchScreen(screenName) {
                // Update tab active state
                document.querySelectorAll('.tab-item').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-screen="${screenName}"]`).classList.add('active');

                // Update screen visibility
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(`${screenName}Screen`).classList.add('active');

                this.currentScreen = screenName;
                
                // Auto-scroll chat to bottom when entering chat screen
                if (screenName === 'chat') {
                    setTimeout(() => {
                        this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
                    }, 100);
                }
            }

            toggleSidebar() {
                if (this.sidebarOpen) {
                    this.closeSidebar();
                } else {
                    this.openSidebar();
                }
            }

            openSidebar() {
                this.sidebar.classList.add('open');
                this.sidebarOverlay.classList.add('visible');
                this.sidebarOpen = true;
                document.body.style.overflow = 'hidden';
            }

            closeSidebar() {
                this.sidebar.classList.remove('open');
                this.sidebarOverlay.classList.remove('visible');
                this.sidebarOpen = false;
                document.body.style.overflow = '';
            }

            selectAgent(agentId) {
                this.currentAgent = agentId;
                
                const agentInfo = this.getAgentInfo(agentId);
                this.chatAgentIcon.textContent = agentInfo.icon;
                this.chatAgentName.textContent = agentInfo.name;
                this.chatAgentStatus.textContent = `‚óè ${agentInfo.status}`;
                
                this.messageInput.placeholder = `Message ${agentInfo.name}...`;
                
                this.switchScreen('chat');
            }

            getAgentInfo(agentId) {
                const agents = {
                    'dee-dee': { icon: 'D', color: '#FF6B35', name: 'Dee Dee', status: 'online' },
                    'zera': { icon: 'Z', color: '#3B82F6', name: 'Zera', status: 'online' },
                    'yacob': { icon: 'Y', color: '#22C55E', name: 'Yacob', status: 'online' },
                    'aman': { icon: 'A', color: '#8B5CF6', name: 'Aman', status: 'offline' },
                    'outstanding': { icon: 'Y', color: '#22C55E', name: 'Outstanding', status: 'online' }
                };
                return agents[agentId] || agents['dee-dee'];
            }

            async sendMessage() {
                const text = this.messageInput.value.trim();
                if (!text) return;

                this.addMessage(text, true);
                this.messageInput.value = '';

                // Show typing indicator
                this.showTypingIndicator();

                try {
                    // Try to send via WebSocket first
                    if (this.ws && this.ws.readyState === WebSocket.OPEN) {
                        this.ws.send(JSON.stringify({
                            type: 'message',
                            agent: this.currentAgent,
                            message: text
                        }));
                    } else {
                        // Fallback to HTTP API
                        const response = await fetch(`${this.apiBase}/api/agents/${this.currentAgent}/message`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ message: text })
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}`);
                        }
                    }
                } catch (error) {
                    console.error('Send message error:', error);
                    this.hideTypingIndicator();
                    
                    // Simulate local response for demo
                    setTimeout(() => {
                        this.simulateAgentResponse(text);
                    }, 1000);
                }
            }

            addMessage(text, isUser = false, agentName = '') {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isUser ? 'user' : 'agent'}`;

                let messageHTML = '';
                if (!isUser && agentName) {
                    messageHTML += `<div class="agent-label">${agentName}</div>`;
                }
                
                messageHTML += `
                    <div class="message-bubble">${this.formatMessage(text)}</div>
                    <div class="message-time">${this.getCurrentTime()}</div>
                `;
                
                messageDiv.innerHTML = messageHTML;
                this.chatContainer.appendChild(messageDiv);
                this.chatContainer.scrollTop = this.chatContainer.scrollHeight;

                this.hideTypingIndicator();
            }

            simulateAgentResponse(userMessage) {
                const agentInfo = this.getAgentInfo(this.currentAgent);
                const responses = [
                    "Working on that now...",
                    "Let me check the system status...",
                    "Task completed successfully!",
                    "Processing your request...",
                    "I'll handle that for you.",
                    "Here's what I found...",
                    "Running diagnostics...",
                    "System is healthy",
                    "Deployment in progress..."
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                this.addMessage(randomResponse, false, `${agentInfo.icon} ${agentInfo.name}`);
            }

            formatMessage(text) {
                return text.replace(/\n/g, '<br>');
            }

            getCurrentTime() {
                const now = new Date();
                return now.toLocaleTimeString('en-US', { 
                    hour: 'numeric', 
                    minute: '2-digit',
                    hour12: true 
                });
            }

            showTypingIndicator() {
                this.typingIndicator.style.display = 'flex';
                this.chatContainer.scrollTop = this.chatContainer.scrollHeight;
            }

            hideTypingIndicator() {
                this.typingIndicator.style.display = 'none';
            }

            updateAgentStatus(status, agentId = null) {
                if (agentId && agentId === this.currentAgent) {
                    this.chatAgentStatus.textContent = `‚óè ${status}`;
                }
            }

            updateProcessStatus(data) {
                // Update process counts if needed
                if (data.running !== undefined) {
                    const runningCountEl = document.getElementById('runningCount');
                    if (runningCountEl) {
                        runningCountEl.textContent = data.running;
                    }
                }
            }

            refreshProcesses() {
                // Add refresh animation
                const refreshBtn = document.getElementById('refreshProcesses');
                if (refreshBtn) {
                    refreshBtn.style.transform = 'rotate(360deg)';
                    refreshBtn.style.transition = 'transform 0.5s ease';
                    
                    setTimeout(() => {
                        refreshBtn.style.transform = '';
                    }, 500);
                }

                // Simulate refresh (replace with actual API call)
                console.log('Refreshing processes...');
            }

            animateProgressBars() {
                setInterval(() => {
                    const progressBars = document.querySelectorAll('.progress-fill');
                    progressBars.forEach(bar => {
                        const currentWidth = parseInt(bar.style.width) || 0;
                        if (currentWidth < 100) {
                            const newWidth = Math.min(currentWidth + Math.random() * 5, 100);
                            bar.style.width = `${newWidth}%`;
                            
                            // Update progress text
                            const textEl = bar.nextElementSibling;
                            if (textEl && textEl.classList.contains('progress-text')) {
                                textEl.textContent = textEl.textContent.replace(/\d+%/, `${Math.floor(newWidth)}%`);
                            }
                        }
                    });
                }, 3000);
            }
        }

        // Initialize the app
        const app = new ClawMobileApp();

        // Add visual feedback for touches
        document.addEventListener('touchstart', function(e) {
            const target = e.target.closest('.tab-item, .agent-item, .recent-item, .process-button, .settings-item, .app-item');
            if (target) {
                target.style.transform = 'scale(0.95)';
                target.style.opacity = '0.7';
            }
        }, { passive: true });

        document.addEventListener('touchend', function(e) {
            const target = e.target.closest('.tab-item, .agent-item, .recent-item, .process-button, .settings-item, .app-item');
            if (target) {
                target.style.transform = '';
                target.style.opacity = '';
            }
        }, { passive: true });

        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // PWA detection and install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('PWA install prompt available');
        });

        // Service Worker registration for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>